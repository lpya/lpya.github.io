import{d as m,D as v,G as w,K as d,o as b,s as S,B as k,C as E,v as T}from"./index-372df34c.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";const N=i=>(k("data-v-bcf2872b"),i=i(),E(),i),z={class:"editorText"},C=N(()=>T("div",{id:"canvas"},null,-1)),H=[C],I=m({__name:"23-editorText",setup(i){let a;v(()=>{_()}),w(()=>{a.parentNode&&a.parentNode.removeChild(a)});const _=()=>{const l=document.getElementById("canvas");if(!l)return;const{clientWidth:r,clientHeight:p}=l,c=new d.Stage({container:"canvas",width:r,height:p}),h=new d.Layer;c.add(h);const e=new d.Text({text:"文本编辑【双击编辑】【按Enter确认】",x:r/2-200,y:p/2-10,fontSize:20,draggable:!0,width:400});h.add(e);const s=new d.Transformer({enabledAnchors:["middle-left","middle-right"],boundBoxFunc:function(f,o){return o.width=Math.max(30,o.width),o}});s.nodes([e]),e.on("transform",function(){e.setAttrs({width:e.width()*e.scaleX(),scaleX:1})}),h.add(s),e.on("dblclick dbltap",()=>{e.hide(),s.hide();const f=e.absolutePosition(),o={x:c.container().offsetLeft+f.x,y:c.container().offsetTop+f.y},t=document.createElement("textarea");a=t,document.body.appendChild(t),t.value=e.text(),t.style.position="absolute",t.style.top=o.y+"px",t.style.left=o.x+"px",t.style.width=e.width()-e.padding()*2+"px",t.style.height=e.height()-e.padding()*2+5+"px",t.style.fontSize=e.fontSize()+"px",t.style.border="none",t.style.padding="0px",t.style.margin="0px",t.style.overflow="hidden",t.style.background="none",t.style.outline="none",t.style.resize="none",t.style.lineHeight=e.lineHeight().toString(),t.style.fontFamily=e.fontFamily(),t.style.transformOrigin="left top",t.style.textAlign=e.align(),t.style.color=e.fill();const y=e.rotation();let x="";y&&(x+="rotateZ("+y+"deg)"),t.style.transform=x,t.style.height="auto",t.style.height=t.scrollHeight+3+"px",t.focus();function u(){t.parentNode&&t.parentNode.removeChild(t),e.show(),s.show(),s.forceUpdate()}function g(n){t.style.width=n+"px"}t.addEventListener("keydown",function(n){n.key==="Enter"&&(e.text(t.value),u()),n.key==="Backspace"&&u()}),t.addEventListener("keydown",function(){let n=e.getAbsoluteScale().x;g(e.width()*n),t.style.height="auto",t.style.height=t.scrollHeight+e.fontSize()+"px"})})};return(l,r)=>(b(),S("div",z,H))}});const F=B(I,[["__scopeId","data-v-bcf2872b"]]);export{F as default};
